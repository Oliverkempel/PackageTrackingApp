\chapter{Gennemgang af kode}
\section{Frontend}
\section{Backend}
\subsection{Oprettelse af Konto}
\begin{figure}[h]
    \begin{minted}[frame=lines,framesep=2mm,baselinestretch=1.2,linenos]{cs}
        // denne funktion sender en Email med sendgrid ved at bruge sendgrids smtp server.
        public async Task SendEmailAsync(string toEmail, string subject, string message)
        {
            var apiKey = "----------------------------------"; // sendgrid api key
            await Execute(apiKey, subject, message, toEmail);
        }
    
        public async Task Execute(string apiKey, string subject, string message, string toEmail)
        {
            _logger.LogInformation(apiKey);
            var client = new SendGridClient(apiKey);
            var msg = new SendGridMessage()
            {
                From = new EmailAddress("mads.gjellerod@gmail.com", "Password Recovery"),
                Subject = subject,
                PlainTextContent = message,
                HtmlContent = message
            };
            msg.AddTo(new EmailAddress(toEmail));
            // fjerner klik tracking fra koden 
            msg.SetClickTracking(false, false);
            var response = await client.SendEmailAsync(msg);
            // sennder en besked til konsollen til at debug evtuelle fejl
            _logger.LogInformation(response.IsSuccessStatusCode
                                   ? $"Email to {toEmail} queued successfully!"
                                   : $"Failure Email to {toEmail}");
        }
    \end{minted}
\caption{EmailSender.cs}\label{code:EmailSender.cs}
\end{figure}
Dette er koden der sender en email når man eksempelvis registere sig på siden og skal 
konfirmitere ens email. når man vil sende en email i programmet kalder man metoden SendEmailAsync.
Denne metode har signature af at være public hvilket betyder at andre metoder kan kalde den. Så har
den også signaturene "async Task" som gør at metoden gøre parrelet med andre opgaver så når man venter på
en Api response så stopper programmet ikke. Denne metode tager tre paramatere som er strege af tekst.
Det første der sker i metoden er at vi laver en variabel der indeholder vores Sendgrid api key.
herefter laves der et kaldt til metoden Execute som bliver kaldt asynkront ved hjælp af "await" operatøren.

I Execute metoden bliver der først oprettet et instans af SendGridClient som indeholder api nøglen.
Derefter bliver der lavet et instans af Klassen SendGridMessage som kaldes msg som bruges til at opbygge. 
Beskenden som skal sendes. Her bliver der sat nogle variabler som hvem den er fra og beksendens indhold. 
den næste er at metoden AddTo bliver brugt til at sætte emailen som beskenden skal sendes til. Herefter bruges metoden 
SetClickTracking som der gives to false værdier til at deaktivere Click tracking. først defineres der en implicit variabel 
som kaldes "response" som vil være den type som der returneres fra SendEmailAsync metoden. Der bruges "await" operatøren som venter
på at metoden fuldfører udførelsen, før koden fortsætter med at køre. client er et obejkt af typen SendGridClient som har metoden
SendEmailAsync som er en asynkron metode.
